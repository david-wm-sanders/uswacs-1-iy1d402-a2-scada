% !TEX TS-program = pdflatex
\documentclass[12pt]{article}

% Package the packages
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[a4paper, margin=0.75in]{geometry}
\usepackage{enumitem}
\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue]{hyperref}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[round]{natbib}
\usepackage{pdfpages}
\usepackage{fancyvrb}
% \usepackage[parfill]{parskip}
% \usepackage{titlesec}
\usepackage{listings}
% \usepackage{graphicx}
% \usepackage{float}
% \usepackage[british]{babel}
% \usepackage{csquotes}
% -

% Configuration
% Change font to Palatino
\renewcommand{\rmdefault}{ppl}
% Change the list item spacing
\setlist{noitemsep}
% Set the bibliography style
\bibliographystyle{usw}
% Set up better chapter titling
% \titleformat{\chapter}{\normalfont\LARGE\bfseries}{\thechapter.}{12pt}{}
% \titlespacing{\chapter}{0pt}{0pt}{12pt}
% \titleformat{\section}{\normalfont\Large\bfseries}{\thesection}{12pt}{}
% \titlespacing{\section}{0pt}{0pt}{6pt}
% \titleformat{name=\section,numberless}{\normalfont\Large\bfseries}{}{0pt}{}
% \titleformat{\subsection}{\normalfont\large\bfseries}{\thesubsection}{12pt}{}
% \titleformat{name=\subsection,numberless}{\normalfont\large\bfseries}{}{0pt}{}
% \titlespacing{\subsection}{0pt}{0pt}{3pt}
% Set up the images path
% \graphicspath{ {deliverables/screenshots/} }
% -

% Custom functions
% Set up an inline todo command
\newcommand{\todo}[1]{\textcolor{red}{todo: #1}}
% Set up a todo environment
\newenvironment{todoenv}
  {\color{red}todo:}
  {\color{black}}
% Set up a terminal command block
\definecolor{light-gray}{gray}{0.95}
\newcommand{\term}[1]{\colorbox{light-gray}{\texttt{#1}}}

% Definitions
% \title{IY1D402\thanks{National Cyber Security Academy, University of South Wales, UK}\\{\textit{\small Cyber Security Tools And Practices}}\\SCADA Investigative Report}
\title{IY1D402{\textit{\small \\Cyber Security Tools And Practices}}\\SCADA Investigative Report}
\author{David Sanders\\{\LARGE 17135397}}
\date{\today}
% -

% Document
\begin{document}

% Cover page setup
\maketitle
\pagebreak
% \fontsize{11.5pt}{11.5pt}\selectfont
\tableofcontents
% \fontsize{12pt}{12pt}\selectfont
% -

% Introduction
\pagebreak
\section{Introduction}
Thales has been contracted to deliver a `secured by design` SCADA \textit{(Supervisory Control and Data Acquisition)} system for a power generator in the UK. The client has significant concerns about the cyber resilience of this SCADA system as it will be deployed in a CNI \textit{(Critical National Infrastructure)} environment.

Thales, acting as both end customer and prime contractor, have approached the NCSA \textit{(National Cyber Security Academy)} and its associates with \textit{Project `IndiCon`}. This project involves, in Phase 1, conducting research into SCADA architectures for CNI, IIoT \textit{(Industrial Internet of Things)}, the security issues/vulnerabilities that SCADA systems are exposed to, and identifying PLCs \textit{(Programmable Logic Controllers)} for future detailed assessment and testing as part of Phase 2.

\todo{In this report, I will...}

% \pagebreak
\section{SCADA/CNI Definitions and Overview}
\subsection{Supervisory Control and Data Acquisition}
SCADA systems are a type of Industrial Control System \textit{(ICS)} that can be used to control industrial processes such as manufacturing, refining, or power generation; infrastructure processes such as water treatment, gas pipelines, and wind farms; and facility-based processes such as airports, space stations, or ships \citep{site:scadasystems}.

SCADA can be used to control processes that are limited geographically to a single site (such as a water treatment plant) and processes that are distributed across multiple sites (such as a gas pipeline network).

\subsection{Critical National Infrastructure}
There national infrastructure sectors in the UK are Chemicals, Civil Nuclear, Communications, Defence, Emergency Services, Energy, Finance, Food, Government, Health, Space, Transport, and Water. Some elements within these sectors are deemed to be CNI.

CNI is defined officially by the UK government as being ``those critical elements of national infrastructure (facilities, systems, sites, property, information, people, networks and processes), the loss or compromise of which would result in major detrimental impact on the availability, delivery or integrity of essential services, leading to severe economic or social consequences or to loss of life'' \citep{site:cpni:cni}.

\pagebreak
% \section{Typical SCADA Architectures for CNI}
\section{Typical SCADA Architectures}
\subsection{Building Blocks and Concept of Operations}
SCADA systems are composed from five essential parts \citep{site:allaboutcircuits:scadaintro:20150831,site:infosecinst:scadacritical:20130222}:
\begin{itemize}
  \item RTUs \textit{(Remote Terminal Units)} collect data from sensors, converting it into digital data that can be fed into the SCADA system. This data can be used by the supervisory system and PLCs as input to make sure that the process is operating correctly or to detect when a change should be made automatically.
  \item PLCs \textit{(Programmable Logic Controllers)}, also known as Smart RTUs, can also handle sensory input. However, unlike RTUs, they are able to perform simple logical calculations without the aid of the supervisory system and can use the results of these calculations to modify the operation of the physical system they are connected to via relays, et cetera. Human operators can modify the functionality of the PLCs remotely from the command centre or from HMI control interfaces attached to physical systems on the site.
  \item A supervisory system that is responsible for collating the data acquired by the SCADA system and issuing automatic control signals to manage the process. The supervisory system's parameters can also be adjusted by human operators as required. The supervisory system acts as a bridge between the HMI software and the PLCs/RTUs that make up the SCADA system.
  \item HMIs \textit{(Human-Machine Interfaces)} present data from the SCADA system to the human operators and allows them to make changes to the operation of the SCADA system by issuing commands to the supervisory system and PLCs. The data shown on HMIs is often rendered into a graphical format to make it easier to understand.
  \item A communication infrastructure to connect all of the above components. These can be cabled or wireless (if the sensors are remote or the SCADA system is distributed). Modbus is the de facto standard communication used for communicating with PLCs in SCADA systems.
\end{itemize}

% \subsection{Industrial Distributed Control Systems}
% \todo{moreblah}

% \subsection{Considerations for CNI}
% \todo{bleuuugh}

\pagebreak
\section{Connectivity Trends}
\begin{todoenv}
  \begin{enumerate}[label=(\alph*)]
    \item connectivity trends
    \item improved interoperability and reduced costs
  \end{enumerate}
\end{todoenv}

\subsection{Generations of SCADA}
SCADA architectures have developed over the years, with increasing connectivity over time a common theme. These architectures can be split into four distinct different generations \citep{site:edgefxkits:scada:20141014}.
\subsubsection*{Generation 1: Monolithic}
Early SCADA systems were developed at a time when common networks did not exist. Due to this, these systems were independent and did not have connectivity to other systems on the site or further afield. Redundancy was achieved by having two mainframes so that if the primary mainframe system failed the backup mainframe could take over control.

In first generation SCADA systems, functionality was generally limited to monitoring sensors in the system and raising alarms if the process deviated from the pre-programmed settings.
\subsubsection*{Generation 2: Distributed}
LANs \textit{(Local Area Networks)} were introduced in second generation SCADA systems. Control functions were distributed across devices that were connected via the LAN. In these systems, the LAN is physically separated from other communications infrastructure on the site.

However, during this generation, the network protocols were still proprietary and not standardised.
\subsubsection*{Generation 3: Networked}

\subsubsection*{Generation 4: Internet of Things}


\pagebreak
\section{Security Issues and Vulnerabilities}
\begin{todoenv}
  \begin{enumerate}[label=(\alph*)]
    \item risks/Vulnerabilities of these systems and future trends - network attacks, architectural issues, etc.
    \item impact on legacy systems vs new systems/equipment
    \item standards - do they help or hinder, and are they being updated to protect systems?
  \end{enumerate}
\end{todoenv}

\pagebreak
\section{Future Research Options}
blah

\pagebreak
\section{Conclusions}
blah



% ------------------------------------------------------------------------------
% \begin{table}[h!]
%   \centering
%   \begin{tabular}{|r l|}
%     \hline
%     IP address: & 192.168.254.132 \\
%     \hline
%     Operating system: & Linux Ubuntu 4.13.0-17-generic x86\_64 \\
%     \hline
%     Open ports: & 80 \textit{[http]}, 442 \textit{[ssh; OpenSSH 7.5p1 Ubuntu 10]} \\
%     \hline
%     Closed ports: & 443 \textit{[https]} \\
%     \hline
%     Price's groups: & phillip adm cdrom sudo dip www-data plugdev lpadmin sambashare \\
%     \hline
%   \end{tabular}
%   \caption{Information on Price's machine and account}
%   \label{table:pricemachineinfo}
% \end{table}

% \begin{Verbatim}[frame=leftline]
% Loaded 393 passwords from 'passwords.txt'
% (001/393; 00.25%) Password != '0'
% (002/393; 00.51%) Password != 'scorpio'
% (003/393; 00.76%) Password != 'buddy'
% ...
% (222/393; 56.49%) Password != 'trustno1'
% (223/393; 56.74%) Password != 'newyork'
% (224/393; 57.00%) Password == 'qwertyuiop'
% Took 0.96 minutes to check 224/393 passwords at a rate of 3.88pw/s.
% Performing recon...
% Logging out.
% \end{Verbatim}

% \begin{Verbatim}[frame=leftline]
% [User]
% Language=en_GB
% FormatsLocale=en_GB.UTF-8
% XSession=
% SystemAccount=true
%
% [InputSource0]
% xkb=gb
% \end{Verbatim}
% ------------------------------------------------------------------------------

% BIBLIOGRAPHY/REFERENCES
\pagebreak
% nocited refs
% \nocite{example:referenceid:here}

% Insert references section, left aligned
\begin{flushleft}
  \bibliography{references}
\end{flushleft}


% APPENDICES
% Appendix~\ref{app:screenshots:7}
% \appendix

% \pagebreak
% \chapter{Screenshot deliverables}
% \section{\texttt{ifconfig}, \texttt{arp-scan}, and \texttt{nmap}}
% \label{app:screenshots:1}
% \begin{figure}[H]
%   \centering
%   \includegraphics[width=0.7\paperheight, angle=-90]{It's_Elementary_my_dear_Watson!-2017-12-06-13-41-10}
% \end{figure}
% \pagebreak

% \pagebreak
% \chapter{File deliverables}
% \section{\texttt{recon.txt}}
% \label{app:files:recon}
% \lstinputlisting[frame=single, basicstyle=\small\ttfamily, showstringspaces=false, breaklines=true, postbreak=\mbox{\textcolor{gray}{$\hookrightarrow$}\space}]{deliverables/files/recon.txt}


\end{document}
